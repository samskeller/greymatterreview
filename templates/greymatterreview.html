<!DOCTYPE HTML>
<html>
	<head>
		<title>Grey Matter</title>
		<link rel="stylesheet" type="text/css" href="/stylesheets/greystyles.css"/>
		<link rel="stylesheet" type="text/css" href="/stylesheets/flat-ui.css"/>
		<script type="text/javascript" src="/scripts/jquery-1.9.1.min.js"></script>
		
		<script>
		function tab(tab_number) {
			$('#Day').hide();
			$('#Week').hide();
			$('#Month').hide();
			$('#Year').hide();
			$('#Ever').hide();
			$('#li_Day').attr("class", "");
			$('#li_Week').attr("class", "");
			$('#li_Month').attr("class", "");
			$('#li_Year').attr("class", "");
			$('#li_Ever').attr("class", "");
			$('#'+tab_number).show();
			$('#li_'+tab_number).attr("class", "active");
		}
		
		$(document).ready(function(){
			$('html').click(function(event) {
				// Hide menus on any click so the user can click away from them to hide them
				var loginTrigger = $("#login-trigger");
				loginTrigger.next('#login-content').toggle(false);
				loginTrigger.removeClass('active');
				
				var signupTrigger = $("#signup-trigger");
				signupTrigger.next('#signup-content').toggle(false);
				signupTrigger.removeClass('active');
				
				var meTrigger = $("#me-trigger");
				//meTrigger.next('#me-content').toggle(false);
				meTrigger.next('#me-content').slideUp(100);
				meTrigger.removeClass('active');
			});
			
			// If we clicked on the login box, though, don't do the code from above
			$("#login-content").click(function(event){
				event.stopPropagation();
			});
			
			// Or if we clicked on the signup box, though, don't do the code from above
			$("#signup-content").click(function(event){
				event.stopPropagation();
			});
			
			// Handling the login trigger to show the dropdown
			$('#login-trigger').click(function(event){
				event.stopPropagation();
				var signupTrigger = $("#signup-trigger");
				if (signupTrigger.hasClass('active') || !$(this).hasClass('active')) {
					signupTrigger.next('#signup-content').toggle(false);
					signupTrigger.removeClass('active');
					$(this).next('#login-content').toggle(true);
					$(this).addClass('active');
				} else {
					$(this).next('#login-content').toggle(false);
					$(this).toggleClass('active');
				}
			});
			
			// Handling the signup trigger to show the dropdown
			$('#signup-trigger').click(function(event){
				event.stopPropagation();
				var loginTrigger = $("#login-trigger");
				if (loginTrigger.hasClass('active') || !$(this).hasClass('active')) {
					loginTrigger.next('#login-content').toggle(false);
					loginTrigger.removeClass('active');
					$(this).next('#signup-content').toggle(true);
					$(this).addClass('active');
				} else {
					$(this).next('#signup-content').toggle(false);
					$(this).toggleClass('active');
				}
			});
			
			// If we clicked on the profile box, though, don't do the code from above
			$("#me-content").click(function(event){
				event.stopPropagation();
			});
	
			// Handling the profile trigger to show the dropdown
			$('#me-trigger').click(function(event){
				event.stopPropagation();
				var signupTrigger = $("#signup-trigger");
				if ($(this).hasClass('active')) {
					//$(this).next('#me-content').toggle(false);
					$(this).next('#me-content').slideUp(100);
					$(this).toggleClass('active');
				} else {
					//$(this).next('#me-content').toggle(true);
					$(this).next('#me-content').slideDown(100);
					$(this).addClass('active');
				}
			});
			
		  });
		</script>
	</head>
<body id="newbody">
	<div id="top">
		<div id="logoHolder">
			<a href="/"><span id="emptySpan"></span></a><img id="toplogo" src="/stylesheets/GMLOGO_grey.jpg" alt="Unknown Person" width=40 height=40>
		</div>
		<nav id="loginNav">
			<ul>
				{% if user: %}
				<li id="me-container">
					<a id="me-trigger" href="#">
						{{user.username}}
					</a>
					<div id="me-content">
						<img id="smallProfileImg" src="/stylesheets/GMLOGO_grey.jpg" alt="Unknown Person" width=28 height=28> 
						<span id="profileDropdownUsername">{{user.username}}</span>
						<br>
						<table>
							<tr>
								<td>
									<a href="/home" style="color:#700000;margin-left:65px;">Profile<span id="emptySpan"></span></a>
								</td>
							</tr>
							<tr>
								<td>
									<a href="/logout" style="color:#700000;margin-left:65px;">Logout<span id="emptySpan"></span></a>
								</td>
							</tr>
						</table>
					</div>
				</li>
		        {% else %}
				<li id="login-container">
					<a id="login-trigger" href="#">
						Log in
					</a>
					<div id="login-content">
						<form method="post" action="/">
							<fieldset id="inputs">
								<input id="login_username" name="username" placeholder="Username" required>   
								<input id="login_password" type="password" name="password" placeholder="Password" required>
							</fieldset>
							<fieldset id="actions">
								<button class="btn btn-wide btn-info mrm" style="background-color:#7F8C8D" type="submit">Log in</button>
								<input name="loginbutton" type="hidden" value="login"/>
							</fieldset>
						</form>
					</div>                     
				</li>
				<li id="signup-container">
					<a id="signup-trigger" href="#">
						Sign up
					</a>
					<div id="signup-content">
						<form method="post" action="/">
							<fieldset id="inputs">
								<input id="signup_username" name="signupUsername" placeholder="Username" required>
								<input id="signup_email" name="signupEmail" placeholder="Email" required>
								<input id="signup_password" type="password" name="signupPassword" placeholder="Password" required>
							</fieldset>
							<fieldset id="actions">
								<button class="btn btn-wide btn-danger mrm" style="background-color:#7F8C8D" type="submit">Sign up</button>
								<input name="signupbutton" type="hidden" value="signup"/>
							</fieldset>
						</form>
					</div>
				</li>
        		{% endif %}
			</ul>
		</nav>
	</div>
	{% if user: %}
			<div id="welcome_message">Welcome, {{user.username}}!</div>
	{% endif %}
		<div id="loginerror">{{login_error}}</div>
	<div id="heading_container">
		<div id="description">
			<a href="/" style="text-decoration:none;"><label id="website_title"><span id="emptySpan"></span>grey<br>matter</label></a>
		</div>
		<div id="mission">what do you have to say about music?</div>
		<div id="searchBar">
			<form method="post" action="/reviews">
			<input type="text" id="searchinput" placeholder="Enter artist or album name" name="searchinput">
			<button class="btn btn-wide btn-primary mrm" type="submit" style="background-color:#700000" id="searchbtn">Search</button>
			</form>
		</div>
	</div>
	<div id="top10container">
		<H3>Top 10</H3>
			<div id=”Tabs”>
				<ul>
					<li id="li_Day" onclick="tab('Day')" style="cursor:pointer">Day</li>
					<li id="li_Week" onclick="tab('Week')" style="cursor:pointer">Week</li>
					<li id="li_Month" onclick="tab('Month')" style="cursor:pointer">Month</li>
					<li id="li_Year" onclick="tab('Year')" style="cursor:pointer">Year</li>
					<li id="li_Ever" onclick="('Ever')" style="cursor:pointer">Ever</li>
				</ul>
			<div id="Tab_Content">
			<div id="Day">
				<p>Day</p>
			</div>
			<div id="Week" style="display: none;"> <!--We set its display as none because we don’t want to make this
				tab visible by default. The only visible/active tab should be Tab 1 until the visitor clicks on Tab 2. -->
				<p>Week</p>
			</div>
			<div id="Month" style="display: none;">
				<p>Month</p>
			</div>
			<div id="Year" style="display: none;">
				<p>Year</p>
			</div>
			<div id="Ever" style="display: none;">
				<p>Ever</p>
			</div>
			</div> <!– End of Content_Area Div –>
			</div> <!– End of Tabs Div –>
	</div>	
	<div id="reviewcontainer">
		<div id="recentReviews">
			<div id="latestReviewsDiv">Latest Reviews</div>
			{% for i in range(reviews|length): %}
				{% if i == 0: %}
					<div class="frontPageReviewLarge">
						<img src="http://www.coverartarchive.com/release/{{reviews[i]['mb_id']}}/front" width="175" height="175" align="middle" onerror="this.src='/stylesheets/GMLOGO.jpg';" style="float:left;margin-right:10px;margin-top:11px;margin-left:10px;">
						<span id="reviewRating">{{reviews[i]['rating']}} / 10</span><span style="float:right;">{{reviews[i]['timePassed']}}</span>
						<br>
						<a href="/artists/{{reviews[i]['artist']}}" id="profileReviewLink">{{reviews[i]['artist']}}</a>
						<br>
						<a href="/albums/{{reviews[i]['mb_id']}}" id="profileReviewLink" style="font-style:italic;color:#1414A4">{{reviews[i]['album']}}</span>
						<br>
						<a href="/user/{{reviews[i]['reviewer']}}" id="profileReviewUserLink">{{reviews[i]['reviewer']}}</a> said: {{reviews[i]['reviewText']}}
					</div>
					<br>
				{% else: %}
					<div class="frontPageReview">
						<img src="http://www.coverartarchive.com/release/{{reviews[i]['mb_id']}}/front" width="120" height="120" align="middle" onerror="this.src='/stylesheets/GMLOGO.jpg';" style="display:inline;margin-left:15px;margin-right:30px;">
						<span id="reviewRating">{{reviews[i]['rating']}} / 10</span>
						<br>
						<a href="/artists/{{reviews[i]['artist']}}" id="profileReviewLink">{{reviews[i]['artist']}}</a>
						<br>
						<a href="/albums/{{reviews[i]['mb_id']}}" id="profileReviewLink" style="font-style:italic;color:#1414A4">{{reviews[i]['album']}}</a>
						<br>
						<a href="/user/{{reviews[i]['reviewer']}}" id="profileReviewUserLink">{{reviews[i]['reviewer']}}</a> said: {{reviews[i]['reviewText']}}
					</div>
				{% endif %}
			{% endfor %}
		</div>
	</div>
</body>
</html>
