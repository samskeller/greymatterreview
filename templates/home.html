<!DOCTYPE HTML>
<html>
        <head>
                <title>The Grey Matter Review</title>
                <link rel="stylesheet" type="text/css" href="/stylesheets/greystyles.css"/>
                <!--Source of background image: http://cstpdx.com/show/specticast-concert-series-andr%C3%A9-rieu -->
				<script type="text/javascript" src="/scripts/jquery-1.9.1.min.js"></script>
        </head>
        <script>
        function changeSearchParam(newValue) {
        	document.getElementById("searchbtn").value = "Find " + newValue;
        	
        }
        </script>
		<script>
		$( document ).ready(function() {
			// Hide menus on any click so the user can click away from them to hide them
			$('html').click(function() {
				// Hide menus
				var meTrigger = $("#me-trigger");
				//meTrigger.next('#me-content').toggle(false);
				meTrigger.next('#me-content').slideUp(100);
				meTrigger.removeClass('active');
			});
			
			// If we clicked on the profile box, though, don't do the code from above
			$("#me-content").click(function(){
				event.stopPropagation();
			});
			
			// Handling the profile trigger to show the dropdown
			$('#me-trigger').click(function(){
				event.stopPropagation();
				var signupTrigger = $("#signup-trigger");
				if ($(this).hasClass('active')) {
					//$(this).next('#me-content').toggle(false);
					$(this).next('#me-content').slideUp(100);
					$(this).toggleClass('active');
				} else {
					//$(this).next('#me-content').toggle(true);
					$(this).next('#me-content').slideDown(100);
					$(this).addClass('active');
				}
			});
		});
		</script>
<body id="homebody">
	<div id="top">
		<div id="logoHolder">
			<a href="/"><span id="emptySpan"></span></a><img id="toplogo" src="/stylesheets/GMLOGO_grey.jpg" alt="Unknown Person" width=40 height=40>
		</div>
		<nav id="loginNav">
			<ul>
				<li id="me-container">
					<a id="me-trigger" href="#">
						{{user.username}}
					</a>
					<div id="me-content">
						<img id="smallProfileImg" src="/stylesheets/GMLOGO_grey.jpg" alt="Unknown Person" width=28 height=28> 
						<span id="profileDropdownUsername">{{user.username}}</span>
						<br>
						<table>
							<tr>
								<td>
									<a href="/home" style="color:#700000;margin-left:65px;">My Page<span id="emptySpan"></span></a>
								</td>
							</tr>
							<tr>
								<td>
									<a href="/logout" style="color:#700000;margin-left:65px;">Logout<span id="emptySpan"></span></a>
								</td>
							</tr>
						</table>
					</div>
				</li>
			</ul>
		</nav>
	</div>
	<br>
	<div id="description">
		<a href="/" style="text-decoration:none;"><label id="website_title"><span id="emptySpan"></span>grey<br>matter</label></a>
	</div>
	<div id="mission">what do you have to say about music?</div>
	<br>
	<br>
	<div id="searchBar">
		<form method="post" action="/reviews">
		<input type="text" id="searchinput" placeholder="Search" name="searchinput">
		<select id="searchdropdown" name="searchdropdown" onChange="changeSearchParam(this.value);">
			<option value="artists">Artists</option>
			<option value="albums">Albums</option>
		</select>	
		<input type="submit" value="Find Artists" id="searchbtn" name="searchbtn">
		</form>
	</div>
	<div id="maincontainer">
		<div id="profile_info">
			<h2 id="profile_name">{{user.username}}</h2>
			<div id="profile_image" onmouseover="document.getElementById('changeprofileimage').style.display='block';" onmouseout="document.getElementById('changeprofileimage').style.display='none';">
				<img src="/stylesheets/GMLOGO.jpg" alt="Unknown Person" width="160" height="180">
				<div id="changeprofileimage"><a href="#" id="changeprofileimagebtn">Edit Profile Image</a></div>
			</div>
			<div id="profile_stats">
				<br>
				<div id="reviewsBox">
					<label class="statLabel">Reviews</label>
					<a href="/friends" style="text-decoration:none;"><div class="numberLabel">{{user.numberOfReviews}}</div></a>
				</div>
				<div id="followingBox">
					<label class="statLabel">Following</label>
					<a href="/friends" style="text-decoration:none;"><div class="numberLabel">{{user.following}}</div></a>
				</div>
				<div id="followersBox">
					<label class="statLabel">Followers</label>
					<a href="/friends" style="text-decoration:none;"><div class="numberLabel">{{user.followers}}</div></a>
				</div>
			</div>
		</div>
		<div id="profilefeed">
			<h2 id="myactivitylabel">My Activity</h2>
			{% if reviews|length == 0: %}
				<p>You've never made a review! Click <a href="/newreview">here</a> to write your first one</p>
			{% endif %}
			{% for review in reviews: %}
				<div class="profileReview">
				{% if not review.rating: %}
					<span id="reviewRating">5 / 10</span>
				{% else: %}
					<span id="reviewRating">{{review.rating}} / 10</span>
				{% endif %}
				<br>
				Artist: <a href="/artists/{{review.artist|escape}}">{{review.artist}}</a>
				<span id="reviewDate">{{review.reviewDate.strftime('%a %B %d, %Y %I:%M%p')}}</span>
				<br>
				Album: <a href="/albums/{{review.reviewMBID}}">{{review.album}}</a>
				<br>
				Review: {{review.reviewText}}
				</div>
				<br>
			{% endfor %}
		</div>
	</div>
	<script type="text/javascript" src="/scripts/jquery-1.9.1.min.js"></script>
</body>
</html>
